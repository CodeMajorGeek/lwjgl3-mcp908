package net.minecraft.client.audio;

import static org.lwjgl.openal.ALC10.*;
import static org.lwjgl.stb.STBVorbis.*;
import static org.lwjgl.system.MemoryUtil.*;

import java.io.File;
import java.io.IOException;
import java.io.InputStream;
import java.net.MalformedURLException;
import java.net.URL;
import java.net.URLConnection;
import java.net.URLStreamHandler;
import java.nio.ByteBuffer;
import java.nio.IntBuffer;
import java.nio.ShortBuffer;

import org.lwjgl.openal.AL;
import org.lwjgl.openal.ALC;
import org.lwjgl.openal.ALCCapabilities;
import org.lwjgl.openal.ALCapabilities;

import net.minecraft.client.Minecraft;
import net.minecraft.client.settings.GameSettings;
import net.minecraft.entity.player.EntityPlayer;
import net.minecraft.util.ResourceLocation;

public class SoundManager {

	private static final String __OBFID = "CL_00001141";

	private long alContext;
	private long alDevice;

	private ALCCapabilities alcCapabilities;
	private ALCapabilities alCapabilities;

	private SoundHandler soundHandler;
	private GameSettings gameSettings;

	public SoundManager(SoundHandler soundHandler, GameSettings gameSettings) {

		this.soundHandler = soundHandler;
		this.gameSettings = gameSettings;

		initializeOpenAL();

		System.out.println("SoundSystem created by CodeMajorGeek started !");
	}

	public void reloadSoundSystem() {

		cleanUpOpenAL();
		initializeOpenAL();

		System.out.println("SoundSystem reloaded !");
	}

	public void playSound(ISound sound) {

		File soundFile = null;

		IntBuffer channelsBuffer = memAllocInt(1);
		IntBuffer sampleRateBuffer = memAllocInt(1);

		ShortBuffer rawAudioBuffer = stb_vorbis_decode_filename(soundData, channelsBuffer, sampleRateBuffer);
	}

	public void addDelayedSound(ISound sound, int delay) {

	}

	public void setListener(EntityPlayer player, float val) {

	}

	public void pauseAllSounds() {

	}

	public void stopAllSounds() {

	}

	public void unloadSoundSystem() {

	}

	public void updateAllSounds() {

	}

	public void resumeAllSounds() {

	}

	public void setSoundCategoryVolume(SoundCategory soundCategory, float level) {

	}

	public void stopSound(ISound sound) {

	}

	public boolean isSoundPlaying(ISound sound) {

		return true;
	}

	private void initializeOpenAL() {

		final String defaultDeviceName = alcGetString(0, ALC_DEFAULT_DEVICE_SPECIFIER);
		alDevice = alcOpenDevice(defaultDeviceName);

		int[] attributes = { 0 };
		alContext = alcCreateContext(alDevice, attributes);
		alcMakeContextCurrent(alContext);

		alcCapabilities = ALC.createCapabilities(alDevice);
		alCapabilities = AL.createCapabilities(alcCapabilities);
	}

	private void cleanUpOpenAL() {

		alcDestroyContext(alContext);
		alcCloseDevice(alDevice);
	}

	private static URL func_148612_a(final ResourceLocation p_148612_0_) {
		String var1 = String.format("%s:%s:%s",
				new Object[] { "mcsounddomain", p_148612_0_.getResourceDomain(), p_148612_0_.getResourcePath() });
		URLStreamHandler var2 = new URLStreamHandler() {
			private static final String __OBFID = "CL_00001143";

			protected URLConnection openConnection(final URL p_openConnection_1_) {
				return new URLConnection(p_openConnection_1_) {
					private static final String __OBFID = "CL_00001144";

					public void connect() {
					}

					public InputStream getInputStream() throws IOException {
						return Minecraft.getMinecraft().getResourceManager().getResource(p_148612_0_).getInputStream();
					}
				};
			}
		};

		try {
			return new URL((URL) null, var1, var2);
		} catch (MalformedURLException var4) {
			throw new Error("TODO: Sanely handle url exception! :D");
		}
	}
}
